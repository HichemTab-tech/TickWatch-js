/*
 * TickWatch-js v1.1.0
 * (c) HichemTech
 * Released under the MIT License.
 * Github: github.com/HichemTab-tech/TickWatch-js
 */

(function(C,_){typeof exports=="object"&&typeof module<"u"?_(exports):typeof define=="function"&&define.amd?define(["exports"],_):_((C=typeof globalThis<"u"?globalThis:C||self)["TickWatch-js"]={})})(this,function(C){"use strict";const _=(n,i=!0)=>n!=null&&(typeof n!="string"||!i||n!==""),j=function(n={},...i){let r=[];const g={start:function(t,e){return e.isCounting=!0,e.timer=setTimeout(()=>{x(p(e))},1e3),y(e),p(e).trigger("TickWatch.start",[e]),t},stop:function(t,e){return e.isCounting=!1,y(e),p(e).trigger("TickWatch.stop",[e]),t},set:function(t,e,a){if(e.settings.displayOnly)e.current=parseInt(a[0]),y(e),b(p(e));else{let u=a[0];u=_(u)?u.trim():"",u.split(":").length===e.partsLength.length&&(e.current=u,y(e),b(p(e)))}return t},clear:function(t,e){return e.current=e.settings.startTime,y(e),b(p(e)),p(e).trigger("TickWatch.clear",[e]),t},option:function(t,e,a){return e.settings===void 0&&(e.settings={}),!_(a)||a.length<1||a.length>2?console.error("Arguments number not valid"):a.length===1?t.push(e.settings[a[0]]):a.length===2&&(e.settings[a[0]]=a[1],y(e)),t},destroy:function(t,e){const a=p(e);return a.trigger("TickWatch.destroy",[e]),a.empty(),a.data("TickWatch",null),a.removeAttr("data-TickWatch-id"),t}};return $(this).each(function(){let t=$(this).data("TickWatch"),e=Math.floor(1e3*Math.random()+100);if(t)typeof n=="string"&&g[n]!==void 0&&(r=g[n](r,t,[...i]));else{let a=$.extend({partsKeys:["seconds","minutes",{hours:24}],direction:"up",startTime:null,endTime:null,activeCellClass:"active-cell",inactiveCellClass:"inactive-cell",displayOnly:!1,displaySize:null},n),u=$(this),T={};for(let d=0;d<a.partsKeys.length;d++){let c=a.partsKeys[d];if(typeof c=="string")T[c]=60;else{let h=Object.keys(c)[0];T[h]=c[h]}}if(t={idSuffix:e,settings:a,parts:T,partsLength:a.partsKeys.length,isCounting:!1,timer:null,current:null},t.settings.displayOnly)t.settings.displaySize=t.settings.displaySize===null?3:t.settings.displaySize,t.settings.displaySize=typeof t.settings.displaySize=="number"?t.settings.displaySize:parseInt(t.settings.displaySize),t.settings.displaySize=isNaN(t.settings.displaySize)?3:t.settings.displaySize,t.current=0;else{let[d,c]=[M(t.settings.partsKeys.length),w(T)];t.settings.startTime===null&&(t.settings.startTime=t.settings.direction==="up"?d:c),t.settings.endTime===null&&(t.settings.endTime=t.settings.direction!=="up"?d:c),t.current=a.startTime}if($(this).data("TickWatch",t),$(this).attr("data-TickWatch-id",e),t.settings.displayOnly){let d=new Array(t.settings.displaySize).fill("").map((c,h)=>"displayPart_"+(h+1));t.parts={};for(let c=0;c<d.length;c++)t.parts[d[c]]=null}$(((d="defaultId",c=["seconds","minutes","hours"],h=!1)=>{const l=16+(h?3:22)+(h?21:42)*(c.length-1),S=h?20:42;return`
                <svg class='TickWatch-clock' id='${d}' viewBox='0 36 ${l} 36' xmlns='http://www.w3.org/2000/svg'>
                    ${((f,k)=>{let v=[];const z=(o,s,m=!1)=>` <g>
                                        <path id='${f}_${o}_${m?"a":"b"}_7' class="clock-cell" d='M${l-16-s},69l3-3h6l3,3c0,0-1,1-3,1h-6C${l-15-s},70,${l-16-s},69,${l-16-s},69z'/>
                                        <path id='${f}_${o}_${m?"a":"b"}_6' class="clock-cell" d='M${l-3-s},55l-3,2v8l3,3c0,0,1-1,1-3v-7C${l-2-s},56,${l-3-s},55,${l-3-s},55z'/>
                                        <path id='${f}_${o}_${m?"a":"b"}_5' class="clock-cell" d='M${l-17-s},55l3,2v8l-3,3c0,0-1-1-1-3v-7C${l-18-s},56,${l-17-s},55,${l-17-s},55z'/>
                                        <polygon id='${f}_${o}_${m?"a":"b"}_4' class="clock-cell" points='${l-13-s},52 ${l-7-s},52 ${l-4-s},54 ${l-7-s},56 ${l-13-s},56 ${l-16-s},54'/>
                                        <path id='${f}_${o}_${m?"a":"b"}_3' class="clock-cell" d='M${l-3-s},40l-3,3v8l3,2c0,0,1-1,1-3v-7C${l-2-s},41,${l-3-s},40,${l-3-s},40z'/>
                                        <path id='${f}_${o}_${m?"a":"b"}_2' class="clock-cell" d='M${l-17-s},40l3,3v8l-3,2c0,0-1-1-1-3v-7C${l-18-s},41,${l-17-s},40,${l-17-s},40z'/>
                                        <path id='${f}_${o}_${m?"a":"b"}_1' class="clock-cell" d='M${l-16-s},39l3,3h6l3-3c0,0-1-1-3-1h-6C${l-15-s},38,${l-16-s},39,${l-16-s},39z'/>
                                    </g>
                                   `;for(let o=0;o<k.length;o++)v.push(`  <g id=${f}_${k[o]}>
                            ${z(k[o],o*S,!0)}
                            ${h?"":z(k[o],o*S+18)}
                        </g>
                    `);return v.reverse(),v.join("")})(d,c)}
                    ${h?"":(f=>{const k=[];for(let v=0;v<f;v++){const z=v*S+40;k.push(`<circle cx='${z}' cy='50' r='2'/><circle cx='${z}' cy='58' r='2'/>`)}return k.reverse(),`<g id='dots'>${k.join("")}</g>`})(c.length-1)}
                </svg>
            `})("TickWatch_"+e,Object.keys(t.parts),t.settings.displayOnly)).appendTo(u),b($(this))}}),r.length>1?r:r.length===0?null:r[0]},M=n=>new Array(n).fill("00").join(":"),w=n=>Object.values(n).map(i=>O(i-1)).join(":"),I=(n,i,r,g)=>{r=[[1,1,1,0,1,1,1],[0,0,1,0,0,1,0],[1,0,1,1,1,0,1],[1,0,1,1,0,1,1],[0,1,1,1,0,1,0],[1,1,0,1,0,1,1],[1,1,0,1,1,1,1],[1,0,1,0,0,1,0],[1,1,1,1,1,1,1],[1,1,1,1,0,1,1]][r];let t=0;for(;t<r.length;){const e=$(`#${n}_${i}_${t+1}`);r[t]===0?(e.removeClass(g.settings.activeCellClass),e.addClass(g.settings.inactiveCellClass)):(e.removeClass(g.settings.inactiveCellClass),e.addClass(g.settings.activeCellClass)),t++}},O=n=>(n+="").length===1?"0"+n:n,x=n=>{let i=n.data("TickWatch");if(i&&i.isCounting){if(i.current===i.settings.endTime)return i.isCounting=!1,y(i),void p(i).trigger("TickWatch.end",[i]);i=K(i),y(i),b(n),setTimeout(function(){x(n)},1e3)}else p(i).trigger("TickWatch.end",[i])},b=n=>{let i=n.data("TickWatch");p(i).trigger("TickWatch.update",[i]);let r,g=i.current;if(i.settings.displayOnly){r=g.toString().split("");for(let e=r.length;e<i.settings.displaySize;e++)r.unshift("0")}else r=g.split(":");r.reverse();let t=Object.keys(i.parts);for(let e=t.length-1;e>=0;e--){let a=t[e],u=r[e],T=i.settings.displayOnly?[u]:u.split("");for(let W=0;W<T.length;W++)I(`TickWatch_${i.idSuffix}_${a}`,W===T.length-1?"a":"b",parseInt(T[W]),i)}},K=n=>{let i=n.current.split(":");i.reverse();let r=Object.values(n.parts);if(i=i.map(t=>parseInt(t)),n.settings.direction==="up")for(let t=0;t<i.length;t++){if(i[t]<r[t]-1){i[t]++;break}i[t]=0}else for(let t=0;t<i.length;t++){if(i[t]>0){i[t]--;break}i[t]=r[t]-1}let g=i.map(t=>O(t));return g.reverse(),n.current=g.join(":"),n},y=n=>{p(n).data("TickWatch",n)},p=n=>$('[data-TickWatch-id="'+n.idSuffix+'"]');jQuery.fn.TickWatch=j,C.TickWatch=j,Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})});
